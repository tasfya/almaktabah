<%# Search Results Content - Results display logic and no results state %>
<% if @results.present? && @total_results > 0 %>
  <% if @results[:mixed].present? %>
    <%# Mixed search results - single list sorted by relevance %>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <% @results[:mixed].each do |hit| %>
        <% partial_name = hit.content_type.to_s.singularize %>
        <%= render "search/results/#{partial_name}", partial_name.to_sym => hit %>
      <% end %>
    </div>
    <%= render "search/pagination" %>
  <% else %>
    <%# Grouped results by content type %>
    <div class="space-y-8">
      <% @results.each do |model_name, hits| %>
        <% next unless hits.present? %>
        <%
          facet_key = model_name.to_s.singularize
          section_total = @facets.dig("content_type")&.find { |f| f[:value] == facet_key }&.dig(:count) || hits.size
        %>
        <%= render "search/search_section", model_name: model_name, hits: hits, total_count: section_total %>
      <% end %>
    </div>
    <%# Show pagination only when single content_type is selected %>
    <% if @hide_content_type_filter %>
      <%= render "search/pagination" %>
    <% end %>
  <% end %>
<% else %>
  <%# No Results State %>
  <div class="flex flex-col items-center justify-center py-12 text-center">
    <div class="mb-6">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-16 h-16 text-gray-400 mx-auto">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
    </div>
    <h3 class="text-xl font-semibold text-gray-900 mb-2">
      <%= t('search.index.no_results_title') %>
    </h3>
    <p class="text-gray-600 mb-6 max-w-md">
      <%= t('search.index.no_results_description') %>
    </p>
    <%# Clear Filters Button (if filters are active) %>
    <% if @search_filters[:scholars].present? || @search_filters[:content_types].present? || @query.present? %>
      <div class="flex flex-col sm:flex-row gap-3 justify-center">
        <% if @search_filters[:scholars].present? || @search_filters[:content_types].present? %>
          <%= link_to url_for(q: @query),
              class: "btn btn-outline" do %>
            <%= t('search.filters.clear_all') %>
          <% end %>
        <% end %>
        <% if @query.present? %>
          <%= link_to url_for(only_path: true),
              class: "btn btn-primary" do %>
            <%= t('search.new_search') %>
          <% end %>
        <% end %>
      </div>
    <% else %>
      <%# Search Suggestions %>
      <div class="bg-base-200 rounded-lg p-6 max-w-lg">
        <h4 class="font-semibold mb-3">
          <%= t('search.suggestions.title') %>
        </h4>
        <ul class="text-left space-y-2 text-sm">
          <li>• <%= t('search.suggestions.try_different') %></li>
          <li>• <%= t('search.suggestions.check_spelling') %></li>
          <li>• <%= t('search.suggestions.use_fewer') %></li>
          <li>• <%= t('search.suggestions.browse_content') %></li>
        </ul>
      </div>
    <% end %>
  </div>
<% end %>
