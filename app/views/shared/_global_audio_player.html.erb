<!-- Global Audio Player -->
<div id="global-audio-player" 
     class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 hidden"
     data-audio-player-target="playerContainer"
     >
  <!-- Audio Element -->
  <audio data-audio-player-target="audio" preload="metadata"></audio>
  <!-- Loading Skeleton -->
  <div data-audio-player-target="skeleton" class="mx-auto px-4 py-3 w-full">
    <div class="flex items-center justify-between w-full">
      <!-- Skeleton Track Info -->
      <div class="flex items-center space-x-4 space-x-reverse min-w-0">
        <div class="w-12 h-12 rounded-lg bg-gray-200 animate-pulse"></div>
        <div class="min-w-0 flex-1">
          <div class="h-4 bg-gray-200 rounded animate-pulse mb-1 max-w-32"></div>
          <div class="h-3 bg-gray-200 rounded animate-pulse max-w-24"></div>
        </div>
      </div>
      <!-- Skeleton Controls -->
      <div class="flex flex-col items-center space-x-6 space-x-reverse mx-auto w-full">
        <div class="flex items-center pb-2 gap-2">
          <div class="size-10 bg-gray-200 rounded-md animate-pulse mb-2"></div>
          <div class="size-10 bg-gray-200 rounded-md animate-pulse mb-2"></div>
        </div>
        <div class="flex flex-row-reverse items-center space-x-3 min-w-0 flex-1 max-w-md w-full">
          <div class="w-8 h-3 bg-gray-200 rounded animate-pulse"></div>
          <div class="w-full h-2 bg-gray-200 rounded-full animate-pulse"></div>
          <div class="w-8 h-3 bg-gray-200 rounded animate-pulse"></div>
        </div>
      </div>
      <!-- Skeleton Additional Controls -->
      <div class="flex items-center space-x-2 space-x-reverse mx-auto">
        <div class="w-12 h-6 bg-gray-200 rounded animate-pulse"></div>
        <div class="w-8 h-8 bg-gray-200 rounded animate-pulse"></div>
        <div class="w-16 h-4 bg-gray-200 rounded animate-pulse"></div>
        <div class="w-8 h-8 bg-gray-200 rounded animate-pulse"></div>
      </div>
    </div>
  </div>
  <!-- Actual Player Container -->
  <div data-audio-player-target="player" class="hidden mx-auto px-4 py-3 w-full">
    <div class="flex items-center justify-between w-full">
      <!-- Track Info -->
      <div class="flex items-center space-x-4 space-x-reverse min-w-0">
        <!-- Artwork -->
        <div class="flex-shrink-0">
          <img data-audio-player-target="artwork" 
               src="/icon.png" 
               alt="Track artwork" 
               class="w-12 h-12 rounded-lg object-cover bg-gray-100">
        </div>
        <!-- Track Details -->
        <div class="min-w-0 flex-1">
          <h4 data-audio-player-target="title" 
              class="text-sm font-semibold text-gray-900 truncate">
            اختر مقطع صوتي
          </h4>
          <p data-audio-player-target="author" 
             class="text-xs text-gray-600 truncate">
            المكتبة
          </p>
        </div>
      </div>
      <!-- Player Controls -->
      <div class="flex flex-col items-center space-x-6 space-x-reverse mx-auto w-full">
        <!-- Play/Pause Button -->
        <div class="flex items-center pb-2 gap-2">
          <button data-audio-player-target="playButton"
                  data-action="click->audio-player#play"
            class="flex items-center justify-center size-10 text-black hover:bg-gray-800 hover:text-white rounded-md transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play h-5 w-5">
              <polygon points="6 3 20 12 6 21 6 3"></polygon>
            </svg>
          </button>
          <button data-audio-player-target="pauseButton"
                  data-action="click->audio-player#pause"
            class="hidden items-center justify-center size-10 text-black hover:bg-gray-800 hover:text-white  rounded-md transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pause h-5 w-5">
              <rect x="14" y="4" width="4" height="16" rx="1"></rect><rect x="6" y="4" width="4" height="16" rx="1"></rect>
            </svg>
          </button>
          <!-- Loop Button -->
          <button data-audio-player-target="loopButton"
                  data-action="click->audio-player#toggleLoop"
            class="flex items-center justify-center size-10 border text-black hover:bg-gray-800 hover:text-white rounded-md transition-colors"
            title="Toggle Loop">
            <svg class="size-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
          </button>
        </div>
        <!-- Progress Section with range input -->
        <div class="flex flex-row-reverse items-center space-x-3 min-w-0 flex-1 max-w-md w-full">
          <!-- Current Time -->
          <span data-audio-player-target="time" class="text-xs text-gray-500 font-mono">
            0:00
          </span>
          <!-- Native Progress Bar -->
          <input
            type="range"
            min="0"
            max="100"
            value="0"
            step="0.1"
            dir="ltr"
            data-audio-player-target="progress"
            data-action="input->audio-player#onSeekInput change->audio-player#onSeekChange"
            class="w-full h-2 rounded-full appearance-none cursor-pointer bg-gray-200
            [&::-webkit-slider-thumb]:appearance-none 
            [&::-webkit-slider-thumb]:cursor-grab
            [&::-webkit-slider-thumb]:w-5 
            [&::-webkit-slider-thumb]:h-5
            [&::-webkit-slider-thumb]:bg-white
            [&::-webkit-slider-thumb]:border
            [&::-webkit-slider-thumb]:border-2
            [&::-webkit-slider-thumb]:border-gray-900
            [&::-webkit-slider-thumb]:transition-colors
            [&::-webkit-slider-thumb]:hover:bg-gray-100
            [&::-webkit-slider-thumb]:focus:outline-none
            [&::-webkit-slider-thumb]:focus:ring-2
            [&::-webkit-slider-thumb]:focus:ring-offset-2
            [&::-webkit-slider-thumb]:focus:ring-gray-400
            [&::-webkit-slider-thumb]:shadow-sm
            [&::-webkit-slider-thumb]:shadow-[0_2px_8px_rgba(0,0,0,0.4)]
            [&::-webkit-slider-thumb]:rounded-full
            "
            />
            <!-- Duration -->
            <span data-audio-player-target="duration" class="text-xs text-gray-500 font-mono">
              0:00
            </span>
          </div>
        </div>
        <!-- Additional Controls -->
        <div class="flex items-center space-x-2 space-x-reverse mx-auto">
          <!-- Speed Control -->
          <div class="flex items-center gap-1">
            <span class="text-xs text-gray-600">السرعة</span>
            <select data-audio-player-target="speedSelect"
                    data-action="change->audio-player#setSpeed"
                    class="text-xs border border-gray-300 rounded px-1 py-0.5 bg-white">
              <option value="0.5">0.5x</option>
              <option value="0.75">0.75x</option>
              <option value="1" selected>1x</option>
              <option value="1.25">1.25x</option>
              <option value="1.5">1.5x</option>
              <option value="1.75">1.75x</option>
              <option value="2">2x</option>
            </select>
          </div>
          <!-- Volume Control -->
          <div class="flex items-center space-x-2">
            <!-- Volume/Mute Button -->
            <button data-audio-player-target="volumeButton"
                    data-action="click->audio-player#toggleMute"
                    class="p-1 text-gray-600 hover:text-gray-900 transition-colors"
                    title="Mute/Unmute">
              <!-- Volume On Icon -->
              <svg data-audio-player-target="volumeOnIcon" 
                   xmlns="http://www.w3.org/2000/svg" 
                   width="24" height="24" viewBox="0 0 24 24" 
                   fill="none" stroke="currentColor" stroke-width="2" 
                   stroke-linecap="round" stroke-linejoin="round" 
                   class="lucide lucide-volume2 h-4 w-4">
                <path d="M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"></path>
                <path d="M16 9a5 5 0 0 1 0 6"></path>
                <path d="M19.364 18.364a9 9 0 0 0 0-12.728"></path>
              </svg>
              <!-- Volume Off/Mute Icon -->
              <svg data-audio-player-target="volumeOffIcon"
                   xmlns="http://www.w3.org/2000/svg"
                   width="24" height="24" viewBox="0 0 24 24"
                   fill="none" stroke="currentColor" stroke-width="2"
                   stroke-linecap="round" stroke-linejoin="round"
                   class="lucide lucide-volume-x h-4 w-4 hidden">
                <path d="M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"></path>
                <line x1="22" x2="16" y1="9" y2="15"></line>
                <line x1="16" x2="22" y1="9" y2="15"></line>
              </svg>
            </button>
            <input
              type="range"
              min="0"
              max="100"
              value="100"
              step="1"
            dir="ltr"
              data-audio-player-target="volumeSlider"
              data-action="input->audio-player#setVolume"
              class="w-16 h-1 rounded-full appearance-none cursor-pointer bg-gray-200
              [&::-webkit-slider-thumb]:appearance-none 
              [&::-webkit-slider-thumb]:cursor-grab
              [&::-webkit-slider-thumb]:w-3 
              [&::-webkit-slider-thumb]:h-3
              [&::-webkit-slider-thumb]:bg-gray-600
              [&::-webkit-slider-thumb]:rounded-full
              [&::-webkit-slider-thumb]:transition-colors
              [&::-webkit-slider-thumb]:hover:bg-gray-800"
              />
            </div>
            <!-- Close Button -->
            <button data-action="click->audio-player#stop"
              class="p-2 text-gray-600 hover:text-gray-900 transition-colors">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
