<div id="global-audio-player" 
     class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 hidden"
     data-audio-player-target="playerContainer"
>
  <audio data-audio-player-target="audio" preload="metadata"></audio>

  <div data-audio-player-target="skeleton" class="mx-auto px-4 py-3 w-full">
    <div class="flex items-center justify-between w-full">
      <div class="flex items-center space-x-4 space-x-reverse min-w-0">
        <div class="w-12 h-12 rounded-lg bg-gray-200 animate-pulse"></div>
        <div class="min-w-0 flex-1">
          <div class="h-4 bg-gray-200 rounded animate-pulse mb-1 max-w-32"></div>
          <div class="h-3 bg-gray-200 rounded animate-pulse max-w-24"></div>
        </div>
      </div>
      <div class="flex flex-col items-center space-x-6 space-x-reverse mx-auto w-full">
        <div class="flex items-center pb-2 gap-2">
          <div class="size-10 bg-gray-200 rounded-md animate-pulse mb-2"></div>
          <div class="size-10 bg-gray-200 rounded-md animate-pulse mb-2"></div>
        </div>
        <div class="flex flex-row-reverse items-center space-x-3 min-w-0 flex-1 max-w-md w-full">
          <div class="w-8 h-3 bg-gray-200 rounded animate-pulse"></div>
          <div class="w-full h-2 bg-gray-200 rounded-full animate-pulse"></div>
          <div class="w-8 h-3 bg-gray-200 rounded animate-pulse"></div>
        </div>
      </div>
      <div class="flex items-center space-x-2 space-x-reverse mx-auto">
        <div class="w-12 h-6 bg-gray-200 rounded animate-pulse"></div>
        <div class="w-8 h-8 bg-gray-200 rounded animate-pulse"></div>
        <div class="w-16 h-4 bg-gray-200 rounded animate-pulse"></div>
        <div class="w-8 h-8 bg-gray-200 rounded animate-pulse"></div>
      </div>
    </div>
  </div>

  <div data-audio-player-target="player" class="hidden mx-auto px-4 py-3 w-full">
    <div class="flex items-center justify-between w-full">
      <div class="flex items-center gap-2 w-fit">
        <div class="flex-shrink-0">
          <img data-audio-player-target="artwork" src="/icon.png" alt="<%= t('audio_player.artwork_alt') %>" class="w-12 h-12 rounded-lg object-cover bg-gray-100">
        </div>
        <div class="min-w-0 flex-1">
          <h4 data-audio-player-target="title" class="text-lg font-semibold text-gray-900">
            <%= t('audio_player.select_audio') %>
          </h4>
          <p data-audio-player-target="author" class="hidden text-xs text-gray-600 truncate">
            <%= t('audio_player.library') %>
          </p>
        </div>
      </div>

      <div class="flex flex-col items-center space-x-6 space-x-reverse mx-auto w-full">
        <div class="flex items-center pb-2 gap-2">
          <button data-audio-player-target="playButton" data-action="click->audio-player#play" class="btn btn-secondary" title="<%= t('audio_player.play') %>">
            <%= icon "play", class:"size-5" %>
          </button>
          <button data-audio-player-target="pauseButton" data-action="click->audio-player#pause" class="hidden btn btn-secondary" title="<%= t('audio_player.pause') %>">
            <%= icon "pause", class:"size-5" %>
          </button>
          <button data-audio-player-target="loopButton" data-action="click->audio-player#toggleLoop" class="btn btn-secondary" title="<%= t('audio_player.loop') %>">
            <%= icon "repeat", library:"lucide", class:"size-5" %>
          </button>
        </div>

        <div class="flex flex-row-reverse items-center space-x-3 min-w-0 flex-1 max-w-md w-full">
          <span data-audio-player-target="time" class="text-xs text-gray-500 font-mono">0:00</span>
          <input
            type="range"
            min="0"
            max="100"
            value="0"
            step="0.1"
            dir="ltr"
            data-audio-player-target="progress"
            data-action="input->audio-player#onSeekInput change->audio-player#onSeekChange"
            class="w-full h-2 rounded-full appearance-none cursor-pointer bg-gray-200
            [&::-webkit-slider-thumb]:appearance-none 
            [&::-webkit-slider-thumb]:cursor-grab
            [&::-webkit-slider-thumb]:w-5 
            [&::-webkit-slider-thumb]:h-5
            [&::-webkit-slider-thumb]:bg-white
            [&::-webkit-slider-thumb]:border
            [&::-webkit-slider-thumb]:border-2
            [&::-webkit-slider-thumb]:border-gray-900
            [&::-webkit-slider-thumb]:transition-colors
            [&::-webkit-slider-thumb]:hover:bg-gray-100
            [&::-webkit-slider-thumb]:focus:outline-none
            [&::-webkit-slider-thumb]:focus:ring-2
            [&::-webkit-slider-thumb]:focus:ring-offset-2
            [&::-webkit-slider-thumb]:focus:ring-gray-400
            [&::-webkit-slider-thumb]:shadow-sm
            [&::-webkit-slider-thumb]:shadow-[0_2px_8px_rgba(0,0,0,0.4)]
            [&::-webkit-slider-thumb]:rounded-full
            "
          />
          <span data-audio-player-target="duration" class="text-xs text-gray-500 font-mono">0:00</span>
        </div>
      </div>

      <div class="flex items-center space-x-2 space-x-reverse mx-auto">
        <div class="flex items-center gap-1">
          <span class="text-xs text-gray-600"><%= t('audio_player.speed') %></span>
          <select data-audio-player-target="speedSelect"
                  data-action="change->audio-player#setSpeed"
                  class="text-xs border border-gray-300 rounded px-1 py-0.5 bg-white"
          >
            <option value="0.5">0.5x</option>
            <option value="0.75">0.75x</option>
            <option value="1" selected>1x</option>
            <option value="1.25">1.25x</option>
            <option value="1.5">1.5x</option>
            <option value="1.75">1.75x</option>
            <option value="2">2x</option>
          </select>
        </div>

        <div class="flex items-center space-x-2">
          <button data-audio-player-target="volumeButton"
                  data-action="click->audio-player#toggleMute"
                  class="p-1 text-gray-600 hover:text-gray-900 transition-colors"
                  title="<%= t('audio_player.mute_unmute') %>"
          >
            <%= icon "speaker-wave", class:"size-5", data: { audio_player_target: "volumeOnIcon"} %>
            <%= icon "speaker-x-mark", class:"size-5 hidden", data: { audio_player_target: "volumeOffIcon"} %>
          </button>
          <input
            type="range"
            min="0"
            max="100"
            value="100"
            step="1"
            dir="ltr"
            data-audio-player-target="volumeSlider"
            data-action="input->audio-player#setVolume"
            class="w-16 h-1 rounded-full appearance-none cursor-pointer bg-gray-200
            [&::-webkit-slider-thumb]:appearance-none 
            [&::-webkit-slider-thumb]:cursor-grab
            [&::-webkit-slider-thumb]:w-3 
            [&::-webkit-slider-thumb]:h-3
            [&::-webkit-slider-thumb]:bg-gray-600
            [&::-webkit-slider-thumb]:rounded-full
            [&::-webkit-slider-thumb]:transition-colors
            [&::-webkit-slider-thumb]:hover:bg-gray-800"
          />
        </div>

        <button data-action="click->audio-player#stop" class="btn" title="<%= t('audio_player.close') %>">
          <%= icon "x-mark", class:"size-5" %>
        </button>
      </div>
    </div>
  </div>
</div>
