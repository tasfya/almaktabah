<% 
  # Locals expected:
  # - stats: hash containing stats data
  # - title: string for card title (default: "إحصائيات الموقع")
  # - compact: boolean for smaller layout (default: false)
  
  title = local_assigns.fetch(:title, t('3ilm.stats.title'))
  icon_name = local_assigns.fetch(:icon, "chart-bar")
  compact = local_assigns.fetch(:compact, false)
  stats = local_assigns.fetch(:stats, {})
  
  default_stats = [
    { key: :lessons_count, label: t('3ilm.stats.lesson'), icon: "play", primary: true },
    { key: :lectures_count, label: t('3ilm.stats.lecture'), icon: "microphone" },
    { key: :books_count, label: t('3ilm.stats.book'), icon: "book-open" },
    { key: :series_count, label: t('3ilm.stats.series'), icon: "folder" }
  ]
%>

<section class="bg-card rounded-lg shadow-sm border border-background-contrast">
  <div class="border-b border-background-contrast <%= compact ? 'p-3' : 'p-4' %>">
    <div class="flex items-center gap-2">
      <h3 class="font-bold text-main-text"><%= title %></h3>
    </div>
  </div>
  
  <div class="<%= compact ? 'p-3' : 'p-4' %>">
    <div class="grid grid-cols-2 <%= compact ? 'gap-3' : 'gap-4' %>">
      <% default_stats.each_with_index do |stat, index| %>
        <div class="text-center <%= compact ? 'p-2' : 'p-3' %> bg-background rounded-lg hover:bg-card-hover transition-colors group">
          <div class="flex flex-col items-center gap-1">
            <div class="<%= compact ? 'w-6 h-6' : 'w-8 h-8' %> bg-primary/10 rounded-full flex items-center justify-center mb-1">
              <%= icon stat[:icon], class: "#{'size-3' if compact} #{'size-4' unless compact} text-primary" %>
            </div>
            <div class="<%= compact ? 'text-lg' : 'text-2xl' %> font-bold <%= stat[:primary] ? 'text-primary' : 'text-main-text' %> group-hover:text-primary transition-colors">
              <%= stats&.dig(stat[:key]) || 0 %>
            </div>
            <div class="text-xs text-card-contrast font-medium">
              <%= stat[:label] %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    
    <% if !compact && stats&.any? %>
      <div class="mt-4 pt-4 border-t border-background-contrast">
        <p class="text-xs text-card-contrast text-center">
          <%= t('3ilm.stats.last_updated', date: Time.current.strftime("%Y/%m/%d")) %>
        </p>
      </div>
    <% end %>
  </div>
</section>
