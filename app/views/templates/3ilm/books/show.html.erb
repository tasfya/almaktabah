<% content_for :title, @book.title %>
<article class="bg-white border border-base-300 rounded-lg shadow-md p-8">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
    <div class="md:col-span-1">
      <% if @book.cover_image.present?%>
        <%= image_tag @book.cover_image, class: "w-full h-full rounded-lg shadow-md", alt: @book.title %>
      <% end %>
    </div>
    <div class="md:col-span-2">
      <header>
        <h1 class="text-3xl font-bold mb-4">
          <%= @book.title %>
        </h1>
        <% if @book.author.present? %>
          <p class="text-xl mb-4">
            <%= link_to @book.author.name, scholar_path(@book.author), class: "hover:link" %>
          </p>
        <% end %>
        <div class="flex flex-wrap items-center gap-4 text-sm mb-6">
          <% if @book.category.present? %>
            <span class="badge badge-primary">
              <%= @book.category %>
            </span>
          <% end %>
        </div>
        <% if @book.description.present? %>
          <section class="mb-8">
            <h2 class="text-2xl font-bold mb-4"><%= t('.book_description') %></h2>
            <div class="prose prose-lg max-w-none">
              <%= simple_format(@book.description) %>
            </div>
          </section>
        <% end %>
        <% if @book.file.present? %>
          <div class="mb-6">
            <%= link_to @book.file, target: "_blank",
                        class: "btn btn-primary" do %>
              <%= icon "arrow-down-tray", class:"size-5" %>
              <%= t("buttons.download_book")%>
            <% end %>
          </div>
        <% end %>
      </header>
    </div>
  </div>
  <% if @book.author.respond_to?(:bio) && @book.author.bio.present? %>
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">
        <%= t(".about_author")%>
      </h2>
      <div class="prose prose-lg max-w-none">
        <%= @book.author.bio %>
      </div>
    </section>
  <% end %>
  <% if @related_books.any? %>
    <section class="mt-12">
      <h2 class="text-2xl font-bold mb-6">
        <%= t(".related_books")%>
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <% @related_books.each do |related_book| %>
          <div class="card card-side card-border bg-base-100 shadow-sm hover:shadow-md transition-shadow">
            <figure class="pr-4 py-4">
              <% if related_book.cover_image.present? %>
                <%= image_tag related_book.cover_image, class: "w-24 h-32 object-cover rounded", alt: related_book.title %>
              <% else %>
                <div class="w-24 h-32 rounded flex items-center justify-center">
                  <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><title>book</title><g fill="currentColor" stroke-linecap="round" stroke-linejoin="round"><line x1="16" y1="5.8" x2="16" y2="31" fill="none" stroke="currentColor" stroke-width="2"></line> <path d="M23.5,2C19.4,2,16,3.6,16,5.8,16,3.6,12.6,2,8.5,2S1,3.6,1,5.8V31c0-2.3,3.4-4,7.5-4S16,28.7,16,31c0-2.3,3.4-4,7.5-4S31,28.7,31,31V5.8C31,3.6,27.6,2,23.5,2Z" fill="none" stroke="currentColor" stroke-width="2"></path></g></svg>
                </div>
              <% end %>
            </figure>
            <div class="card-body">
              <h3 class="card-title">
                <%= link_to related_book.title, book_path(related_book), class: "hover:text-primary-500" %>
              </h3>
              <% if related_book.author.present? %>
                <p class="text-sm">
                  <%= related_book.author.respond_to?(:name) ? related_book.author.name : related_book.author %>
                </p>
              <% end %>
              <div class="card-actions justify-start">
                <span class="badge badge-primary"><%= related_book.category %></span>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </section>
  <% end %>
</article>
